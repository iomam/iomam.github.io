
<!DOCTYPE html>
<html>
  <head>
<script async src="https://api.glia.com/salemove_integration.js"></script>
<script>function findQueuingInstructionsElement(){return document.querySelector('div.instructions');}
  function findQueueElement(queueName){return document.querySelector("div.queue[queue_name='"+queueName+"']");}
function findAllQueueElements(){return document.querySelectorAll('div.queue');}
function findAllQueueMediaButtons(){return document.querySelectorAll('div.queue button.media_button');}
function findMediaButtonsForQueue(queueElement){return queueElement.querySelectorAll('button.media_button');}
function findCancelButton(){return document.querySelector('button.cancel');}
function getMediaButtonQueueName(button){return button.parentElement.getAttribute('queue_name');}
function getButtonMedium(button){return button.getAttribute('medium');}
function hide(element){console.log('firing hide');console.log(element);}
function show(element){console.log('firing show');console.log(element);}
function showCanQueue(queueElement,queueMedias){queueElement.classList.remove('disabled');queueElement.disabled=false;updateQueueAvailableMedia(queueElement,queueMedias)}
function showCannotQueue(queueElement){queueElement.classList.add('disabled');queueElement.disabled=true;updateQueueAvailableMedia(queueElement,[])}
function showCannotQueueAnywhere(){findAllQueueElements().forEach(showCannotQueue);}
function showFailedToQueueView(error){findQueuingInstructionsElement().innerText='Sorry! Currently unavailable.';}
function showCanQueueView(){findQueuingInstructionsElement().innerHTML='Please select a queue and click a media button';}
function showAlreadyQueuedView(){findQueuingInstructionsElement().innerText='Please wait, you will be connected shortly';}
function showCannotQueueView(){findQueuingInstructionsElement().innerText='Queueing is currently disabled';}
function updateQueueAvailableMedia(queueElement,medias){findMediaButtonsForQueue(queueElement).forEach(function(button){var mediaUnavailable=medias.indexOf(getButtonMedium(button))===-1;if(mediaUnavailable){button.classList.add('disabled');button.disabled=true;}else{button.classList.remove('disabled');button.disabled=false;}})}
var queueTicket;function listenForQueueButtonClicks(salemove,queues){findAllQueueMediaButtons().forEach(function(mediaButton){var buttonQueueName=getMediaButtonQueueName(mediaButton);var buttonMedium=getButtonMedium(mediaButton);var queueId=queues.filter(function(queue){return queue.name===buttonQueueName;}).map(function(queue){return queue.id;})[0];if(queueId===undefined){throw new Error('Queue button present, but queue not defined in Glia. Queue name: '+
buttonQueueName);}
mediaButton.addEventListener('click',function(){if(buttonMedium==='phone'){var visitorPhoneNumber='+11111111111';salemove.queueForEngagement(buttonMedium,{queueId:queueId,phoneNumber:visitorPhoneNumber}).catch(showFailedToQueueView);}else{salemove.queueForEngagement(buttonMedium,{queueId:queueId}).catch(showFailedToQueueView);}});});}
function listenForCancel(){findCancelButton().addEventListener('click',function(){if(queueTicket){queueTicket.cancel();}else{throw new Error('Cannot cancel queuing while not queued');}});}
function onQueueState(queue){if(findQueueElement(queue.name)===null){}else if(queue.state.status===queue.state.STATUSES.OPEN){showCanQueue(findQueueElement(queue.name),queue.state.medias);}else{showCannotQueue(findQueueElement(queue.name));}}
function onVisitorQueueingState(queuingState){if(queuingState.state===queuingState.QUEUE_STATES.QUEUED){queueTicket=queuingState.ticket;findAllQueueElements().forEach(hide);show(findCancelButton());showAlreadyQueuedView();}else if(queuingState.state===queuingState.QUEUE_STATES.CANNOT_QUEUE){queueTicket=null;findAllQueueElements().forEach(hide);hide(findCancelButton());showCannotQueueView();}else{queueTicket=null;findAllQueueElements().forEach(show);hide(findCancelButton());showCanQueueView();}}
showCannotQueueAnywhere();hide(findCancelButton());sm.getApi({version:'v1'}).then(function(salemove){salemove.addEventListener(salemove.EVENTS.QUEUE_STATE_UPDATE,onVisitorQueueingState);listenForCancel();salemove.getQueues().then(function(queues){listenForQueueButtonClicks(salemove,queues);var queueIds=queues.map(function(queue){return queue.id;});salemove.subscribeToQueueStateUpdates(queueIds,onQueueState);});});</script>
  </head>
<body style="background-color:pink;">

</div>
<h1>My First Heading</h1>
<p>My first paragraph.</p>
   <a data-sm-show-media-selection-on="click" href="javascript:void(0);">Contact us</a>
</div>    
    <br>
    
 <br>
 <br>

 <a href="https://erxxmoves.tumblr.com/">Different domain</a>

<div>
  <div class="instructions"></div>
  <div class="queue" queue_name="Default Queue">
    <span> Need help with the product? </span>
    <button class="media_button" medium="text">Chat using your browser</button>
    <button class="media_button" medium="audio">
      Speak using your computer microphone
    </button>
    <button class="media_button" medium="phone">Speak using your phone</button>
    <button class="media_button" medium="video">
      Speak using your computer camera and microphone
    </button>
    <button class="cancel">Leave queue</button>
  </div>

</body>
</html>
